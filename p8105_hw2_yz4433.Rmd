---
title: "p8105_hw2_yz4433"
author: "Yifei Zhao"
date: "2022-10-01"
output: github_document
---

```{r, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE, message = FALSE)
library(tidyverse)
library(readxl)
```

## Problem 1

## Problem 2
### Manipulate the Mr.Trash Wheel sheet
```{r}
data_mr = read_excel("data/Trash Wheel Collection Data.xlsx") %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(group = "mr")
data_mr = data_mr[,-15:-16]
data_mr[,13] = as.integer(unlist(round(data_mr[,13])))
```

### Manipulate the Professor Trash Wheel sheet and make combination
```{r}
data_pro = read_excel("data/Trash Wheel Collection Data.xlsx",2) %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  add_column(sports_balls = 0, .after = "chip_bags") %>% 
  mutate(group = "professor")
data_pro[,3] = as.character(unlist(data_pro[,3]))
data_trash =
  bind_rows(data_mr, data_pro) %>%
  janitor::clean_names() %>%
  select(group, everything())
```
For Mr. Trash Wheel data, a `r nrow(data_mr)` $\times$ `r ncol(data_mr)` dataset, the key variables are date and weight_tons, and it illustrates the amount of total litter and litter type from May 2014 to July 2022. For Professor Trash Wheel data, a `r nrow(data_pro)` $\times$ `r ncol(data_pro)` dataset, the key variables are also date and weight_tons, and it illustrates the amount of  precipitation and litter type from Jan 2017 to July 2022. The final resulting dataset has 641 observations. The key variables are date and weight_tons. After calculation, the total weight of trash collected by Professor Trash Wheel is `r sum(data_pro$weight_tons)`, and the total number of sports balls collected by Mr. Trash Wheel in 2020 is `r sum(data_mr$weight_tons[382:452])`.

## Problem 3
### pols-month manipulation
```{r}
data_pols = 
  read_csv("data/fivethirtyeight_datasets/pols-month.csv") %>%
  janitor::clean_names() %>% 
  separate(mon, into = c("year", "month", "day")) %>%
  mutate(president = "group")
data_pols$president = ifelse(data_pols$prez_gop != 0, 'gop', 'dem') 
data_pols = select(data_pols, -day, -prez_dem, -prez_gop)
data_pols$month = month.abb[as.numeric(unlist(data_pols$month))]
```

### snp manipulation
```{r}
data_snp = 
  read_csv("data/fivethirtyeight_datasets/snp.csv") %>% 
  janitor::clean_names() %>% 
separate(date, into = c("month", "day", "year")) %>%
select(year, month, close, -day)
data_snp$month = month.abb[as.numeric(unlist(data_snp$month))]
data_snp$tw = c('20')
data_snp$ni = c('19')
data_snp[1:187,] = mutate(data_snp[1:187,], year = str_c(tw,year))
data_snp[188:787,] = mutate(data_snp[188:787,], year = str_c(ni,year))
data_snp = data_snp[,-4:-5]
```

### unemployment manipulation
```{r}
data_unem = 
  read_csv("data/fivethirtyeight_datasets/unemployment.csv") %>%
  rename(year = Year) %>% 
  pivot_longer(
    Jan:Dec,
    names_to = "month", 
    values_to = "value")
data_unem[,1] = as.character(unlist(data_unem[,1]))
data_unem = data_unem[-811:-816,]
```

### Merge datasets
```{r}
middata = full_join(data_pols, data_snp, by = c("year","month"))
finaldata = full_join(middata, data_unem, by = c("year","month"))
```